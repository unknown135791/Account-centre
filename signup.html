<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sign Up</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #eaeaea;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
    }

    .container {
      background: white;
      width: 100%;
      max-width: 900px;
      border-radius: 20px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.25);
      padding: 50px 40px;
      box-sizing: border-box;
    }

    h2 {
      font-size: 42px;
      text-align: center;
      margin-bottom: 25px;
    }

    .content {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .google-btn {
      width: 100%;
      max-width: 520px;
      padding: 20px;
      font-size: 20px;
      border-radius: 12px;
      border: 1px solid #ccc;
      background: white;
      cursor: not-allowed;
      margin-bottom: 25px;
    }

    .divider {
      font-size: 18px;
      margin: 15px 0;
      color: #888;
    }

    form {
      width: 100%;
      max-width: 520px;
    }

    input {
      width: 100%;
      padding: 18px;
      margin: 14px 0;
      font-size: 18px;
      border-radius: 12px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    /* üîë password wrapper */
    .password-wrapper {
      position: relative;
    }

    .toggle-eye {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 18px;
      user-select: none;
      color: #555;
    }

    button[type="submit"] {
      width: 100%;
      padding: 20px;
      font-size: 22px;
      border-radius: 14px;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 20px;
    }

    .login-link {
      margin-top: 18px;
      text-align: center;
      font-size: 16px;
    }

    .login-link a {
      color: #007bff;
      text-decoration: none;
    }

    /* üî¥ Error text */
    #errorMsg {
      color: red;
      margin-top: 12px;
      font-size: 15px;
      display: none;
      text-align: center;
    }
  </style>
</head>

<body>

  <div class="container">
    <h2>Create Account</h2>

    <div class="content">
      <button class="google-btn" disabled>
        Continue with Google (coming soon)
      </button>

      <div class="divider">or</div>

      <form id="signupForm">
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="email" id="email" placeholder="Email" required>

        <!-- üîë Password with eye -->
        <div class="password-wrapper">
          <input type="password" id="password" placeholder="Password" required>
          <span class="toggle-eye" id="toggleEye">üëÅÔ∏è</span>
        </div>

        <button type="submit">Sign Up</button>

        <p id="errorMsg"></p>

        <div class="login-link">
          Already have an account?
          <a href="login.html">Login</a>
        </div>
      </form>
    </div>
  </div>

<script>
const form = document.getElementById("signupForm");
const errorMsg = document.getElementById("errorMsg");
const passwordInput = document.getElementById("password");
const toggleEye = document.getElementById("toggleEye");

/* üëÅÔ∏è Show / hide password */
toggleEye.addEventListener("click", () => {
  if (passwordInput.type === "password") {
    passwordInput.type = "text";
    toggleEye.textContent = "üôà";
  } else {
    passwordInput.type = "password";
    toggleEye.textContent = "üëÅÔ∏è";
  }
});

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  errorMsg.style.display = "none";

  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = passwordInput.value;

  /* üîê Password length check */
  if (password.length < 8) {
    errorMsg.textContent = "Password must be at least 8 characters long.";
    errorMsg.style.display = "block";
    return;
  }

  try {
    const res = await fetch(
      "https://trail-backend-y8vc.onrender.com/signup",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email, password })
      }
    );

    const data = await res.json();

    if (!res.ok) {
      if (data.message === "Email already in use") {
        errorMsg.textContent = "Email is already in use. Try login.";
      } else {
        errorMsg.textContent = "Signup failed. Please try again.";
      }
      errorMsg.style.display = "block";
      return;
    }

    // ‚úÖ Success
    localStorage.setItem("user", JSON.stringify(data.user));
    window.location.href = "dashboard.html";

  } catch (err) {
    errorMsg.textContent = "Server error. Please try again.";
    errorMsg.style.display = "block";
  }
});
</script>

</body>
</html>